<?xml version="1.0"?>

<project name="main.build"
          default="synchronize"
          basedir=".">

   <!-- Property File definitions -->
   <property file="local.properties"/>
   <property file="synchronize.properties"/>
   <property environment="env"/>

   <!-- Property Definitions -->
   <property name="generatedLibrariesFiles" value="../thirdparty/libraries.ent"/>

   <!-- Allow jbossbuild.repository to be set from (in order or priority)
      + Command line -Djbossbuild.repository=...
      + synchronize.properties jbossbuild.repository setting
      + JBOSS_REPOSITORY environment variable
   -->
   <condition property="jbossbuild.repository" value="${env.JBOSS_REPOSITORY}">
      <isset property="env.JBOSS_REPOSITORY"/>
   </condition>
   <!-- Fall back to default -->
   <property name="jbossbuild.repository" value="http://repository.jboss.org"/>

   <!-- File Imports -->
   <import file="../tools/etc/jbossbuild/tasks.xml"/>


   <!-- Main Definition of dependencies -->
   <build id="jbossmc-thirdparty"
          impltitle="JBossMC"
          implversion="2.0"
          implvendor="JBoss Inc."
          implurl="http://www.jboss.org"
          description="JBoss Microcontainer"
          cvsroot="${cvs.prefix}@cvs.forge.jboss.com:/cvsroot/jboss"
          thirdpartypath="../thirdparty/"
          location="${jbossbuild.repository}"
          targetdefs="targets">

      <!--
        The repository is in CVS under the module repository.jboss.com whose contents
        are pushed to the http://repository.jboss.com site.
      -->
      <!-- log4j: Needed for standalone release + direct dependency from aspects module -->
      <componentref name="apache-log4j" version="1.2.14-brew"/>
      <!-- Dom4j: aop -->
      <componentref name="dom4j" version="1.6.1jboss"/>
      <!-- beanshell: aspects -->
      <componentref name="beanshell" version="1.3.0"/>
      <!-- javassist: aop, asintegration, aspects-->
      <componentref name="javassist" version="3.8.0.GA"/>
      <!-- jboss-cl: jboss-classloader.jar used by asintegration tests -->
      <componentref name="jboss/jboss-cl" version="2.0.0.Beta11"/>
      <!-- common-core: aop, asintegration, aspects -->
      <componentref name="jboss/common-core" version="2.2.7.GA"/>
      <!-- common-logging-log4j: Needed for standalone release -->
      <componentref name="jboss/common-logging-log4j" version="2.0.5.GA"/>
      <!-- common-logging-spi: aop, asintegration, aspects -->
      <componentref name="jboss/common-logging-spi" version="2.0.5.GA"/>
      <!-- integration/jboss-classloading-spi.jar: asintegration -->
      <componentref name="jboss/integration" version="5.0.0.Beta4"/>
      <!-- jboss-mdr: aop, asintegration -->
      <componentref name="jboss/jboss-mdr" version="2.0.0.Beta15"/>
      <!-- jboss-reflect: aop -->
      <componentref name="jboss/jboss-reflect" version="2.0.0.Beta12"/>
      <!-- jboss-reflect: asintegration -->
      <componentref name="jboss/jboss-vfs" version="2.0.0.Beta19"/>
      <!-- jboss-deployers: asintegration -->
      <componentref name="jboss/jboss-deployers" version="2.0.0.Beta12"/>
      <!-- jboss-deployers: asintegration build dependency -->
      <componentref name="jboss/jboss-managed" version="2.0.0.Beta10.1"/>
      <!-- jvmti: aop memory tests -->
      <componentref name="jboss/profiler/jvmti" version="1.0.0.CR5"/>
      <!-- jvmti: aop tests -->
      <componentref name="jboss/test" version="1.0.3.GA"/>
      <!-- core-libs: asintegration (for jboss 4) -->
      <componentref name="jbossas/core-libs" version="4.0.4.GA"/>
      <!-- junit: aop, asintegration,  tests -->
      <componentref name="junit" version="3.8.2-brew"/>
      <!-- qdox: aop -->
      <componentref name="qdox" version="1.6.1"/>
      <!-- sun-javacc: parsers in aop -->
      <componentref name="sun-javacc" version="4.0-brew"/>
      <!-- trove: aop -->
      <componentref name="trove" version="2.1.1"/>
      <!-- xdoclet: aop -->
      <componentref name="xdoclet" version="1.2.3-brew"/>
   </build>

   <synchronizeinfo/>

   <!-- Generate the targets -->
   <generate generate="jbossmc-thirdparty"/>


   <target name="generate-lib-file"
      description="generate libraries.ent and thirdparty license info"
      depends="synchronize">
         <gen-lib-file filename="${generatedLibrariesFiles}" />
      <visit-componentref-graph
         componentVisitor="org.jboss.ant.util.graph.ComponentRefGraphLicenseVisitor" />
   </target>

</project>

