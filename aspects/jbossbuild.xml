<?xml version="1.0"?>

<!--
 JBoss, the OpenSource J2EE webOS
 
 Distributable under LGPL license.
 See terms of license at gnu.org.
-->

<!-- ================================================================== -->
<!-- Aspects component defitinion                                         -->
<!-- ================================================================== -->

<project name="project" 
         default="build" 
         basedir="."
>
   <import file="../tools/etc/jbossbuild/tasks.xml"/>
   <import file="component-info.xml"/>


   <!-- Todo: determince necessary properties -->
  <property name="jboss.jmx.root" value="../jmx/output/classes"/>

   <!-- =============================================================== -->
   <!-- The component definition                                        -->
   <!-- =============================================================== -->

   <componentdef component="aspects" description="aspects">

      <!-- ============================================================ -->
      <!-- The main source                                              -->
      <!-- ============================================================ -->

      <source id="main" >
         <include component="system"/>      
         <include component="common"/>
         <include component="aop"/>                        
         <include component="oswego-concurrent"/>
         <include component="cluster"/>                          
         <include component="server"/>
         <include component="transaction"/>                           
         <include component="j2ee"/>
         <include component="apache-log4j"/>   
         <include component="javassist"/>
         <include component="beanshell"/> 
         <include component="container"/>   
         <include component="j2se"/>     
         <include component="jmx"/>  
         <include component="test"/>
         <include component="kernel"/>         
         <include component="junit"/>
         <include component="naming"/>  
         <include component="jboss/remoting"/>
         <include component="sun-servlet"/>
         <include component="dependency"/> 
         <include component="apache-logging"/>
         <include component="trove"/>
      </source>
      
      <source id="jdk15" requiredJDK="1.5" jvmSource="1.5" jvmTarget="1.5">
         <include component="system"/>      
         <include component="common"/>
         <include component="aop"/>                        
         <include component="oswego-concurrent"/>
         <include component="cluster"/>                          
         <include component="server"/>
         <include component="transaction"/>                           
         <include component="j2ee"/>
         <include component="apache-log4j"/>   
         <include component="javassist"/>
         <include component="beanshell"/> 
         <include component="container"/>   
         <include component="j2se"/>     
         <include component="jmx"/>  
         <include component="test"/>
         <include component="kernel"/>         
         <include component="junit"/>
         <include component="naming"/>  
         <include component="jboss/remoting"/>
         <include component="sun-servlet"/>
         <include component="dependency"/> 
         <include component="apache-logging"/>          
         <include input="main"/>
      </source>      


      <resource id="aspects-xml" 
                path="../etc"/>
      <resource id="aspects-resources"
                path="." />

      <!-- ============================================================ -->
      <!-- jboss-aspect-library.jar                                     -->
      <!-- ============================================================ -->

      <artifactdef artifact="jboss-aspect-library.jar">
         <include input="main">
            <include pattern="org/jboss/**"/>
            <exclude pattern="**/*.properties"/>                        
          </include>
         <include input="aspects-xml" >
	    <include pattern="org/jboss/**/*.xml"/>
         </include>         
      </artifactdef>

      <!-- ============================================================ -->
      <!-- jboss-aspect-library32.jar                                     -->
      <!-- ============================================================ -->

      <artifactdef artifact="jboss-aspect-library32.jar">
         <include input="main">
            <include pattern="org/jboss/**"/>
            <exclude pattern="**/*.properties"/>                        
         </include>
         <include input="aspects-xml" >
	    <include pattern="org/jboss/**/*.xml"/>
         </include> 
         <include component="common" input="jboss-common.jar">
            <include pattern="org/jboss/util/file/ArchiveBrowser*.class"/>
            <include pattern="org/jboss/util/file/ClassFileFilter.class"/>
            <include pattern="org/jboss/util/file/ArchiveBrowser.class"/>
            <include pattern="org/jboss/util/file/JarArchiveBrowser.class"/>
            <include pattern="org/jboss/util/file/DirectoryArchiveBrowser.class"/>             
         </include>              
      </artifactdef>
      
      <!-- ============================================================ -->
      <!-- jboss-aop.deployer                                           -->
      <!-- ============================================================ -->

      <artifactdef artifact="jboss-aop.deployer">
         <include component="aspects" input="jboss-aspect-library.jar" />
         <include component="aop" input="jboss-aop.jar" >
         </include>
         <include input="aspects-xml" >
            <include pattern="base-aop.xml" />
         </include>       
          <include component="javassist" input="javassist.jar" />
         <include component="trove" input="trove.jar" />
         <include input="aspects-resources">
            <include pattern="META-INF/jboss-service.xml" /> 
         </include>
      </artifactdef>   
      
      <!-- ============================================================ -->
      <!-- jboss-aop-jdk50.deployer                                           -->
      <!-- ============================================================ -->

      <artifactdef artifact="jboss-aop-jdk50.deployer" requiredJDK="1.5">
         <include component="aspects" input="jboss-aspect-library-jdk50.jar" />
         <include component="aop" input="jboss-aop-jdk50.jar" >
         </include>
         <include input="aspects-xml" >
            <include pattern="base-aop.xml" />
         </include>       
          <include component="javassist" input="javassist.jar" />
         <include component="trove" input="trove.jar" />
         <include input="aspects-resources">
            <include pattern="META-INF/jboss-service.xml" /> 
         </include>
      </artifactdef>    
      
      
      
      <!-- ============================================================ -->
      <!-- jboss-aop-jdk50.deployer                                     -->
      <!-- ============================================================ -->

      <artifactdef artifact="jboss-aspect-library-jdk50-jb32.jar" requiredJDK="1.5">
         <include input="main">
            <include pattern="org/jboss/**/*.class"/>
            <exclude pattern="org/jboss/aspects/asynchronous/aspects/jboss/Asynchronous.class"/>
            <exclude pattern="org/jboss/aspects/asynch/Asynchronous.class"/>
            <exclude pattern="org/jboss/aspects/asynch/AsynchExecutor.class"/>
            <exclude pattern="org/jboss/aspects/asynch/ThreadPoolExecutor*.class"/>
            <exclude pattern="org/jboss/aspects/asynch/FutureImpl.class"/>
            <exclude pattern="org/jboss/aspects/Current.class"/>
            <exclude pattern="org/jboss/aspects/jmx/MBean.class"/>
            <exclude pattern="org/jboss/test/**/*.class"/>
            <exclude pattern="org/jboss/aspects/Injected.class"/>
            <exclude pattern="org/jboss/aspects/dbc/Dbc.class"/>
            <exclude pattern="org/jboss/aspects/dbc/Invariant.class"/>
            <exclude pattern="org/jboss/aspects/dbc/PostCond.class"/>
            <exclude pattern="org/jboss/aspects/dbc/PreCond.class"/>
            <exclude pattern="org/jboss/aspects/dbc/StaticInvariant.class"/>
            <exclude pattern="org/jboss/aspects/tx/TxType.class"/>
            <exclude pattern="org/jboss/aspects/tx/Tx.class"/>
            <exclude pattern="org/jboss/aspects/tx/TxLocal.class"/>
            <exclude pattern="org/jboss/aspects/txlock/TxSynchronized.class"/>
            <exclude pattern="org/jboss/aspects/security/SecurityDomain.class"/>
            <exclude pattern="org/jboss/aspects/security/Exclude.class"/>
            <exclude pattern="org/jboss/aspects/security/Unchecked.class"/>
            <exclude pattern="org/jboss/aspects/security/RunAs.class"/>
            <exclude pattern="org/jboss/aspects/security/Permissions.class"/>
         </include>
         <include input="jdk15">
            <include pattern="org/jboss/**/*.class"/>
         </include>
         <include input="aspects-xml">
            <include pattern="org/jboss/**/*.xml"/>
         </include>
         <include input="jboss-common.jar">
            <include pattern="org/jboss/util/file/ArchiveBrowser*.class"/>
            <include pattern="org/jboss/util/file/ClassFileFilter.class"/>
            <include pattern="org/jboss/util/file/DirectoryArchiveBrowser.class"/>
            <include pattern="org/jboss/util/file/JarArchiveBrowser.class"/>
         </include>
      </artifactdef> 
      
      <!-- ============================================================ -->
      <!-- jboss-aspect-library-jdk50.jar                               -->
      <!-- ============================================================ -->

      <artifactdef artifact="jboss-aspect-library-jdk50.jar" requiredJDK="1.5">
         <include input="main">
	    <include pattern="org/jboss/**/*.class"/>
	    <exclude pattern="org/jboss/aspects/asynchronous/aspects/jboss/Asynchronous.class"/>
	    <exclude pattern="org/jboss/aspects/asynch/Asynchronous.class"/>
	    <exclude pattern="org/jboss/aspects/asynch/AsynchExecutor.class"/>
	    <exclude pattern="org/jboss/aspects/asynch/ThreadPoolExecutor*.class"/>
	    <exclude pattern="org/jboss/aspects/asynch/FutureImpl.class"/>
	    <exclude pattern="org/jboss/aspects/Current.class"/>
	    <exclude pattern="org/jboss/aspects/jmx/MBean.class"/>
	    <exclude pattern="org/jboss/test/**/*.class"/>
	    <exclude pattern="org/jboss/aspects/Injected.class"/>
	    <exclude pattern="org/jboss/aspects/dbc/Dbc.class"/>
	    <exclude pattern="org/jboss/aspects/dbc/Invariant.class"/>
	    <exclude pattern="org/jboss/aspects/dbc/PostCond.class"/>
	    <exclude pattern="org/jboss/aspects/dbc/PreCond.class"/>
	    <exclude pattern="org/jboss/aspects/dbc/StaticInvariant.class"/>
	    <exclude pattern="org/jboss/aspects/tx/TxType.class"/>
	    <exclude pattern="org/jboss/aspects/tx/Tx.class"/>
	    <exclude pattern="org/jboss/aspects/tx/TxLocal.class"/>
	    <exclude pattern="org/jboss/aspects/txlock/TxSynchronized.class"/>
	    <exclude pattern="org/jboss/aspects/security/SecurityDomain.class"/>
	    <exclude pattern="org/jboss/aspects/security/Exclude.class"/>
	    <exclude pattern="org/jboss/aspects/security/Unchecked.class"/>
	    <exclude pattern="org/jboss/aspects/security/RunAs.class"/>
	    <exclude pattern="org/jboss/aspects/security/Permissions.class"/>
         </include>
         <include input="jdk15">
            <include pattern="org/jboss/**/*.class"/>
         </include>
         <include input="aspects-xml">
            <include pattern="org/jboss/**/*.xml"/>
         </include>
      </artifactdef>        
      

    
   </componentdef>

   <!-- Generate the targets -->   
   <generate generate="aspects"/>

</project>
